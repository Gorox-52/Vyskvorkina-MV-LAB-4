# Лабораторная работа №4: Симуляция библиотеки с пользовательскими коллекциями

**Тема:** Пользовательские коллекции, наследование и псевдослучайная симуляция
**Вариант:** Вариант 1 — «Библиотека»  
**Студент:** Выскворкина Мария Викторовна  
**Группа:** М8О-105БВ-25  
**Преподаватель:** Кира Лейченко  

## Описание проекта
Реализация системы управления библиотекой с пользовательскими коллекциями и псевдослучайной симуляцией событий.

## Цель работы
Разработать систему, демонстрирующую работу с пользовательскими коллекциями, наследованием классов и псевдослучайной симуляцией событий в контексте управления библиотекой.

## Структура проекта
```
LAB_4_PYTHONCHIK/
├── models/
│   ├── __init__.py
│   ├── book.py              # Класс Book
│   ├── collection.py        # Пользовательские коллекции
│   ├── library.py          # Класс Library
│   └── simulation/
│       ├── __init__.py
│       └── simulation.py   # Симулятор событий
├── main.py                  # Главный файл запуска
├── README.md               # Документация
└── .gitignore              # Игнорируемые файлы
```

## Архитектура системы

### 1. **Класс Book** (`book.py`)
- **Поля**: `title`, `author`, `year`, `genre`, `isbn`
- **Магические методы**: `__repr__`, `__str__`, `__eq__`, `__hash__`
- **Дополнительные методы**: `to_dict()`

### 2. **Пользовательские коллекции** (`collection.py`)

#### BookCollection (списковая коллекция)
- Наследует поведение списка через композицию
- **Поддерживает**: `__iter__`, `__len__`, `__getitem__`, срезы, `__contains__`
- **Методы**: `add_book()`, `remove_book()`

#### IndexDict (словарная коллекция)
- Наследует от `dict`
- Автоматическая индексация по: ISBN, автору, году
- **Поддерживает**: автоматическое обновление индексов
- **Методы поиска**: `find_by_isbn()`, `find_by_author()`, `find_by_year()`

### 3. **Класс Library** (`library.py`)
- Объединяет коллекции книг и индексов
- **Методы**:
  - `add_book()` - добавление книги
  - `remove_book()` - удаление книги
  - `find_by_*()` - поиск по различным критериям
  - `search_books()` - гибкий поиск по критериям

### 4. **Симулятор** (`simulation.py`)
- Класс `LibrarySimulator`
- Метод `run_simulation(steps=20, seed=None)`
- **8 типов случайных событий**:
  1. Добавление новой книги
  2. Удаление случайной книги
  3. Поиск по автору
  4. Поиск по году
  5. Поиск по жанру
  6. Поиск по ISBN
  7. Поиск несуществующей книги (тестирование обработки ошибок)
  8. Обновление индексов

### Настройки симуляции (в `main.py`):
```python
steps = 20      # Количество шагов симуляции
seed = 52       # Seed для воспроизводимости (None для случайной)
```

## Требования к выполнению (из задания)

### Выполненные требования:

1. **Две пользовательские коллекции**:
   - `BookCollection` - списковая коллекция через композицию
   - `IndexDict` - словарная коллекция с автоматической индексацией

2. **Поддержка коллекциями**:
   - `__iter__` - итерирование
   - `__len__` - длина
   - `__getitem__` - доступ по индексу/ключу
   - Поддержка срезов (для BookCollection)
   - Добавление и удаление элементов

3. **Логика предметной области**:
   - `IndexDict` индексирует книги по ISBN, автору и году

4. **Наследование классов**:
   - Базовый класс `dict` (для IndexDict)
   - Производные классы переопределяют поведение

5. **Магические методы**:
   - `Book`: `__repr__`, `__str__`, `__eq__`, `__hash__`
   - `BookCollection`: `__iter__`, `__len__`, `__getitem__`, `__contains__`
   - `IndexDict`: `__setitem__`, `__delitem__`

6. **Функция симуляции**:
   - `run_simulation(steps=20, seed=None)`
   - Использует `random` с поддержкой `seed`
   - Воспроизводимая последовательность событий
   - Логирование в консоль

## Пример вывода симуляции
```
=== Шаг 1 ===
Добавлена книга: Война и мир (ISBN: 123-456-789)
Всего книг в библиотеке: 1

=== Шаг 2 ===
Поиск по автору 'Толстой': найдено 1 книг
    - Война и мир (1869)
Всего книг в библиотеке: 1

=== Шаг 3 ===
Поиск несуществующей книги (ISBN: 000-000-000): не найдено
Поиск несуществующего автора 'Неизвестный Автор': найдено 0 книг
Всего книг в библиотеке: 1
```